% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prepare_PCA_data.R
\name{prepare_PCA_data}
\alias{prepare_PCA_data}
\title{Prepare PCA Data for TCGA and Mouse Models}
\usage{
prepare_PCA_data(
  tcga_file,
  mouse_files,
  sample_counts,
  batch_correction = TRUE
)
}
\arguments{
\item{tcga_file}{Character. Path to TCGA expression data file.}

\item{mouse_files}{Named list of file paths for mouse model expression data.}

\item{sample_counts}{Named list specifying the number of normal and tumor samples for each dataset.
Each dataset must have a \code{normal} and \code{tumor} entry, e.g.,
\code{list("TCGA" = c(normal = 50, tumor = 374), "Our_Model" = c(normal = 3, tumor = 2))}}

\item{batch_correction}{Logical. Whether to apply batch correction (default: \code{TRUE}).}
}
\value{
A list containing:
\describe{
\item{merged_data}{Merged expression matrix (genes Ã— samples).}
\item{group_all}{Sample group labels (normal/tumor for each dataset).}
\item{batch}{Batch assignment for each sample (dataset source).}
\item{corrected_data}{Batch-corrected expression matrix (if \code{batch_correction = TRUE}).}
}
}
\description{
\itemize{
\item Reads expression data from \strong{TCGA} and \strong{multiple mouse cancer models}.
\item Ensures gene expression data are standardized and merged based on homologous genes.
\item Allows optional \strong{batch correction} using \code{ComBat}.
}
}
\details{
This function processes gene expression data from TCGA and multiple mouse models
to generate a merged expression matrix suitable for PCA analysis.
\itemize{
\item Uses \strong{gene names as row identifiers} to merge datasets.
\item \strong{Sample grouping} (\code{group_all}) and \strong{batch effects} (\code{batch}) are dynamically assigned.
\item If \code{batch_correction = TRUE}, batch correction is applied using \code{ComBat}.
}
}
\examples{
\dontrun{
mouse_files <- list(
  "Our_Model" = "./data/Our_Model.homo.csv",
  "GSE172629" = "./data/GSE172629.homo.tsv"
)
sample_counts <- list(
  "TCGA" = c(normal = 50, tumor = 374),
  "Our_Model" = c(normal = 3, tumor = 2),
  "GSE172629" = c(normal = 3, tumor = 3)
)
pca_data <- prepare_PCA_data(
  tcga_file = "./data/TCGA.tsv",
  mouse_files = mouse_files,
  sample_counts = sample_counts,
  batch_correction = TRUE
)
}

}
